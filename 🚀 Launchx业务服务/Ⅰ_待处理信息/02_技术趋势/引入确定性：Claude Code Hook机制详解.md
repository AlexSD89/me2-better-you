---
source: "https://mp.weixin.qq.com/s/2EbF7cxioOr_5zrWkXAg9g"
created: 2025-08-05
---
åŸåˆ› TecDeTec *2025å¹´07æœˆ02æ—¥ 00:36*

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/6lfpre8l9tS0rHUVdTcV8icz1olZ1DSGx0H3eicWO6Gib1jkM5HphNlh3q87DiaSLfpGS1aia7nDunciaVpcDm41hD2A/640?wx_fmt=png&from=appmsg&watermark=1&tp=webp&wxfrom=5&wx_lazy=1)

## 0\. å¼•è¨€

Claude Codeçš„æœ€æ–°ç‰ˆæœ¬ï¼ˆ1.0.38ï¼‰å¼•å…¥äº†é’©å­ï¼ˆHooksï¼‰æœºåˆ¶ï¼Œå…¶æœ¬è´¨æ˜¯é€šè¿‡åœ¨Claude Codeç”Ÿå‘½å‘¨æœŸçš„å…³é”®èŠ‚ç‚¹ï¼ˆå¦‚ `PreToolUse` ã€ `PostToolUse` ã€ `Notification` ã€ `Stop` ï¼‰æ³¨å…¥ç”¨æˆ·å®šä¹‰çš„Shellå‘½ä»¤ï¼Œå®ç°å¯¹æ¨¡å‹è¡Œä¸ºçš„ç¡¬æ€§çº¦æŸå’ŒåŠŸèƒ½æ‹“å±•ã€‚è¿™å¥—æœºåˆ¶çš„çœŸæ­£å¨åŠ›ä¸åœ¨äºå®ç°ç®€å•çš„è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼ˆå¦‚ä»£ç æ ¼å¼åŒ–æˆ–æ—¥å¿—è®°å½•ï¼‰ï¼Œè€Œåœ¨äºæ„å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„ã€å¯å®šåˆ¶çš„ â€œæ™ºèƒ½æŠ¤æ â€ ä¸ â€œåŠ¨æ€åé¦ˆç³»ç»Ÿâ€ ã€‚

**å…¶é«˜é˜¶ä»·å€¼ä½“ç°åœ¨ä»¥ä¸‹å‡ ç‚¹ï¼š**

1. 1\. **ç¡®å®šæ€§æ§åˆ¶** ï¼šä¼ ç»Ÿä¸Šï¼Œæˆ‘ä»¬é€šè¿‡promptå·¥ç¨‹â€œè¯·æ±‚â€æˆ–â€œå»ºè®®â€LLMéµå®ˆæŸäº›è§„åˆ™ï¼Œä½†è¿™æ— æ³•ä¿è¯100%çš„éµä»æ€§ã€‚é’©å­æœºåˆ¶å°†è¿™äº›è½¯æ€§è¯·æ±‚ç¡¬åŒ–ä¸ºä»£ç çº§è§„åˆ™ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€šè¿‡ `PreToolUse` é’©å­ï¼Œåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å™¨æ‹¦æˆªæ‰€æœ‰ `grep` å‘½ä»¤ï¼Œå¹¶é€šè¿‡è¿”å›é€€å‡ºç  `2` æ¥é˜»å¡å®ƒï¼ŒåŒæ—¶åœ¨ `stderr` ä¸­å‘Claudeåé¦ˆâ€œè¯·ä½¿ç”¨æ€§èƒ½æ›´ä¼˜çš„ `rg` å‘½ä»¤â€ï¼Œä»è€Œå¼ºåˆ¶æ¨¡å‹å­¦ä¹ å¹¶ä½¿ç”¨æ›´ç¬¦åˆå›¢é˜Ÿè§„èŒƒçš„å·¥å…·ã€‚
2. 2\. **é—­ç¯åé¦ˆä¸è‡ªä¸»ä¿®æ­£** ï¼šé€šè¿‡ `stdin` æ¥æ”¶åŒ…å«ä¸Šä¸‹æ–‡çš„JSONè¾“å…¥ï¼Œå¹¶åˆ©ç”¨ `stdout` è¿”å›ç»“æ„åŒ–çš„JSONæŒ‡ä»¤ï¼ˆå¦‚ `"decision": "block"` ï¼‰ï¼Œé’©å­èƒ½å®ç°å¯¹æ¨¡å‹è¡Œä¸ºçš„å®æ—¶è£å†³å’Œå¹²é¢„ã€‚è¿™ä¸ä»…æ˜¯å•å‘çš„å‘½ä»¤æ‰§è¡Œï¼Œæ›´æ˜¯ä¸€ä¸ªé—­ç¯ç³»ç»Ÿã€‚ä¸€ä¸ª `PostToolUse` é’©å­å¯ä»¥åœ¨æ–‡ä»¶å†™å…¥åç«‹å³è¿è¡Œé™æ€åˆ†æå·¥å…·ï¼Œå¦‚æœå‘ç°ä¸åˆè§„çš„ä»£ç ï¼Œå¯ä»¥ç«‹å³é˜»å¡åç»­æµç¨‹ï¼Œå¹¶å°†å…·ä½“çš„é”™è¯¯ä¿¡æ¯ä½œä¸º `reason` åé¦ˆç»™Claudeï¼Œä»¤å…¶åœ¨ä¸‹ä¸€æ¬¡å°è¯•ä¸­è‡ªè¡Œä¿®æ­£ã€‚
3. 3\. **æ— ç¼é›†æˆä¸ç¯å¢ƒæ„ŸçŸ¥** ï¼šé’©å­ä¸æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰å·¥å…·çš„æ— ç¼é›†æˆï¼Œæ„å‘³ç€å®ƒå¯ä»¥ç›‘ç®¡å’Œæ§åˆ¶ä¸å¤–éƒ¨ç³»ç»Ÿï¼ˆå¦‚GitHubã€æ–‡ä»¶ç³»ç»Ÿï¼‰çš„äº¤äº’ï¼Œæå¤§åœ°æ‰©å±•äº†å…¶åº”ç”¨è¾¹ç•Œã€‚å®ƒä½¿Claudeèƒ½â€œæ„ŸçŸ¥â€å¹¶ä¸¥æ ¼éµå®ˆæœ¬åœ°å¼€å‘ç¯å¢ƒçš„ç‰¹å®šçº¦æŸå’Œå·¥ä½œæµã€‚
4. 4\. **å®‰å…¨ä¸æƒé™çš„ç²¾ç»†åŒ–ç®¡ç†** ï¼šé’©å­æœºåˆ¶æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œå®ƒä»¥ç”¨æˆ·çš„å®Œæ•´æƒé™è¿è¡Œï¼Œå¸¦æ¥äº†å¼ºå¤§çš„èƒ½åŠ›å’ŒåŒç­‰çš„å®‰å…¨è´£ä»»ã€‚ä½†è®¾è®¡è€…é€šè¿‡é…ç½®åŠ è½½çš„å®‰å…¨æœºåˆ¶ï¼ˆä¿®æ”¹ä¸ç«‹å³ç”Ÿæ•ˆï¼Œéœ€åœ¨ `/hooks` èœå•ä¸­å®¡æ ¸ï¼‰æä¾›äº†ä¸€å±‚ç¼“å†²ï¼Œé˜²æ­¢äº†æ¶æ„è„šæœ¬çš„å³æ—¶æ³¨å…¥ã€‚

æ€»ä¹‹ï¼ŒClaude Codeçš„é’©å­æœºåˆ¶æ˜¯ä¸€ç§å‰ç»æ€§çš„è®¾è®¡ï¼Œå®ƒè¶…è¶Šäº†ç®€å•çš„â€œå·¥å…·ä½¿ç”¨â€ï¼Œæ—¨åœ¨é€šè¿‡ä»£ç åŒ–çš„è§„åˆ™å’Œåé¦ˆï¼Œå°†LLMçš„å¼ºå¤§æ¨ç†èƒ½åŠ›å¼•å¯¼åˆ°ä¸€æ¡å¯é¢„æµ‹ã€å¯ä¿¡èµ–ä¸”é«˜åº¦å®šåˆ¶åŒ–çš„è½¨é“ä¸Šï¼Œæ˜¯å®ç°LLMåœ¨ä¸¥è‚ƒè½¯ä»¶å·¥ç¨‹é¢†åŸŸå¯é åº”ç”¨çš„å…³é”®ä¸€æ­¥ã€‚

## 1\. Hooks å®˜æ–¹å‚è€ƒï¼ˆè¯‘ï¼‰

é€šè¿‡æ³¨å†Œ shell å‘½ä»¤ï¼Œè‡ªå®šä¹‰å’Œæ‰©å±• Claude Code çš„è¡Œä¸ºã€‚

### ç®€ä»‹

Claude Code Hooks æ˜¯ç”¨æˆ·å®šä¹‰çš„ shell å‘½ä»¤ï¼Œåœ¨ Claude Codeç”Ÿå‘½å‘¨æœŸçš„ä¸åŒèŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚Hooks ä¸º Claude Code çš„è¡Œä¸ºæä¾›äº†ç¡®å®šæ€§çš„æ§åˆ¶ï¼Œç¡®ä¿æŸäº›æ“ä½œæ€»æ˜¯ä¼šå‘ç”Ÿï¼Œè€Œä¸æ˜¯ä¾èµ– LLM æ¥é€‰æ‹©æ˜¯å¦æ‰§è¡Œå®ƒä»¬ã€‚

ä½¿ç”¨åœºæ™¯ç¤ºä¾‹åŒ…æ‹¬ï¼š

- â€¢ **é€šçŸ¥** ï¼šå½“ Claude Code ç­‰å¾…ä½ çš„è¾“å…¥æˆ–è®¸å¯æ¥æ‰§è¡ŒæŸé¡¹æ“ä½œæ—¶ï¼Œè‡ªå®šä¹‰é€šçŸ¥æ–¹å¼ã€‚
- â€¢ **è‡ªåŠ¨æ ¼å¼åŒ–** ï¼šæ¯æ¬¡æ–‡ä»¶ç¼–è¾‘åï¼Œå¯¹ `.ts` æ–‡ä»¶è¿è¡Œ prettier ï¼Œå¯¹ `.go` æ–‡ä»¶è¿è¡Œ gofmt ç­‰ã€‚
- â€¢ **æ—¥å¿—è®°å½•** ï¼šå‡ºäºåˆè§„æ€§æˆ–è°ƒè¯•ç›®çš„ï¼Œè·Ÿè¸ªå¹¶ç»Ÿè®¡æ‰€æœ‰å·²æ‰§è¡Œçš„å‘½ä»¤ã€‚
- â€¢ **åé¦ˆ** ï¼šå½“ Claude Code ç”Ÿæˆçš„ä»£ç ä¸ç¬¦åˆä½ çš„ä»£ç åº“è§„èŒƒæ—¶ï¼Œæä¾›è‡ªåŠ¨åé¦ˆã€‚
- â€¢ **è‡ªå®šä¹‰æƒé™** ï¼šé˜»æ­¢å¯¹ç”Ÿäº§æ–‡ä»¶æˆ–æ•æ„Ÿç›®å½•çš„ä¿®æ”¹ã€‚

é€šè¿‡å°†è¿™äº›è§„åˆ™ç¼–ç ä¸º Hooks è€Œä¸æ˜¯é€šè¿‡æç¤ºæŒ‡ä»¤ï¼Œä½ å¯ä»¥å°†å»ºè®®è½¬åŒ–ä¸ºåº”ç”¨çº§åˆ«çš„ä»£ç ï¼Œæ¯æ¬¡éƒ½èƒ½åœ¨é¢„æœŸæ—¶æ‰§è¡Œã€‚

> **è­¦å‘Š**
> 
> Hooks åœ¨æ²¡æœ‰ç¡®è®¤çš„æƒ…å†µä¸‹ï¼Œä»¥ä½ çš„å®Œæ•´ç”¨æˆ·æƒé™æ‰§è¡Œ shell å‘½ä»¤ã€‚ä½ æœ‰è´£ä»»ç¡®ä¿ä½ çš„ Hooks æ˜¯å®‰å…¨å¯é çš„ã€‚Anthropic å¯¹å› ä½¿ç”¨ Hooks å¯¼è‡´çš„ä»»ä½•æ•°æ®ä¸¢å¤±æˆ–ç³»ç»ŸæŸåæ¦‚ä¸è´Ÿè´£ã€‚è¯·æŸ¥é˜… å®‰å…¨æ³¨æ„äº‹é¡¹ <sup><span>[1]</span></sup> ã€‚

### å¿«é€Ÿå…¥é—¨

åœ¨æœ¬å¿«é€Ÿå…¥é—¨ä¸­ï¼Œä½ å°†æ·»åŠ ä¸€ä¸ª Hookï¼Œç”¨äºè®°å½• Claude Code è¿è¡Œçš„ shell å‘½ä»¤ã€‚

å¿«é€Ÿå…¥é—¨å‰ææ¡ä»¶ï¼šå®‰è£… jq ï¼Œä»¥ä¾¿åœ¨å‘½ä»¤è¡Œä¸­å¤„ç† JSONã€‚

#### æ­¥éª¤ 1ï¼šæ‰“å¼€ Hooks é…ç½®

è¿è¡Œ **/hooks** æ–œæ å‘½ä»¤ <sup><span>[2]</span></sup> å¹¶é€‰æ‹© PreToolUse Hook äº‹ä»¶ã€‚

PreToolUse Hooks åœ¨å·¥å…·è°ƒç”¨ä¹‹å‰è¿è¡Œï¼Œå¯ä»¥é˜»æ­¢å®ƒä»¬ï¼Œå¹¶å‘ Claude æä¾›å…³äºå¦‚ä½•è¿›è¡Œä¸åŒæ“ä½œçš„åé¦ˆã€‚

#### æ­¥éª¤ 2ï¼šæ·»åŠ åŒ¹é…å™¨

é€‰æ‹© \+ Add new matcherâ€¦ ä»¥ä¾¿ä½ çš„ Hook ä»…åœ¨ Bash å·¥å…·è°ƒç”¨æ—¶è¿è¡Œã€‚

ä¸ºåŒ¹é…å™¨é”®å…¥ Bash ã€‚

#### æ­¥éª¤ 3ï¼šæ·»åŠ  Hook

é€‰æ‹© \+ Add new hookâ€¦ å¹¶è¾“å…¥æ­¤å‘½ä»¤ï¼š

```
jq -r '"\(.tool_input.command) - \(.tool_input.description // "No description")"' >> ~/.claude/bash-command-log.txt
```

#### æ­¥éª¤ 4ï¼šä¿å­˜é…ç½®

å¯¹äºå­˜å‚¨ä½ç½®ï¼Œé€‰æ‹© User settings ï¼Œå› ä¸ºä½ è¦å°†æ—¥å¿—è®°å½•åˆ°ä½ çš„ä¸»ç›®å½•ä¸­ã€‚è¿™æ ·ï¼Œæ­¤ Hook å°†é€‚ç”¨äºæ‰€æœ‰é¡¹ç›®ï¼Œè€Œä¸ä»…ä»…æ˜¯å½“å‰é¡¹ç›®ã€‚

ç„¶åæŒ‰ Esc é”®ç›´åˆ°è¿”å› REPLã€‚ä½ çš„ Hook ç°åœ¨å·²æ³¨å†Œï¼

#### æ­¥éª¤ 5ï¼šéªŒè¯ä½ çš„ Hook

å†æ¬¡è¿è¡Œ **/hooks** æˆ–æ£€æŸ¥ ~/.claude/settings.json æ–‡ä»¶ï¼Œä½ ä¼šçœ‹åˆ°ä½ çš„é…ç½®ï¼š

```
"hooks" :{
"PreToolUse":[
    {
      "matcher":"Bash",
      "hooks":[
        {
          "type":"command",
          "command":"jq -r '\"\\(.tool_input.command) - \\(.tool_input.description // \"No description\")\"' >> ~/.claude/bash-command-log.txt"
        }
      ]
    }
]
}
```

### é…ç½®

Claude Code Hooks åœ¨ä½ çš„ è®¾ç½®æ–‡ä»¶ <sup><span>[3]</span></sup> ä¸­è¿›è¡Œé…ç½®ï¼š

- â€¢ ~/.claude/settings.json \- ç”¨æˆ·è®¾ç½®
- â€¢ .claude/settings.json \- é¡¹ç›®è®¾ç½®
- â€¢ .claude/settings.local.json \- æœ¬åœ°é¡¹ç›®è®¾ç½®ï¼ˆä¸åº”æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼‰
- â€¢ ä¼ä¸šç®¡ç†çš„ç­–ç•¥è®¾ç½®

#### ç»“æ„

Hooks æŒ‰åŒ¹é…å™¨ï¼ˆmatcherï¼‰ç»„ç»‡ï¼Œæ¯ä¸ªåŒ¹é…å™¨å¯ä»¥æœ‰å¤šä¸ª Hooksï¼š

```
{
  "hooks":{
    "EventName":[
      {
        "matcher":"ToolPattern",
        "hooks":[
          {
            "type":"command",
            "command":"your-command-here"
          }
        ]
      }
    ]
}
}
```
- â€¢ **`matcher`** ï¼šåŒ¹é…å·¥å…·åç§°çš„æ¨¡å¼ï¼ˆä»…é€‚ç”¨äº PreToolUse å’Œ PostToolUse ï¼‰ã€‚
- â€¢ ç®€å•å­—ç¬¦ä¸²ç²¾ç¡®åŒ¹é…ï¼š Write ä»…åŒ¹é… Write å·¥å…·ã€‚
	- â€¢ æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼š Edit|Write æˆ– Notebook.\* ã€‚
	- â€¢ å¦‚æœçœç•¥æˆ–ä¸ºç©ºå­—ç¬¦ä¸²ï¼ŒHooks å°†å¯¹æ‰€æœ‰åŒ¹é…äº‹ä»¶è¿è¡Œã€‚
- â€¢ **`hooks`** ï¼šæ¨¡å¼åŒ¹é…æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤æ•°ç»„ã€‚
- â€¢ **`type`** ï¼šç›®å‰ä»…æ”¯æŒ "command" ã€‚
	- â€¢ **`command`** ï¼šè¦æ‰§è¡Œçš„ bash å‘½ä»¤ã€‚

### Hook äº‹ä»¶

#### PreToolUse

åœ¨ Claude åˆ›å»ºå·¥å…·å‚æ•°ä¹‹åã€å¤„ç†å·¥å…·è°ƒç”¨ä¹‹å‰è¿è¡Œã€‚

å¸¸è§çš„åŒ¹é…å™¨ï¼š

- â€¢ Task \- ä»£ç†ä»»åŠ¡
- â€¢ Bash \- Shell å‘½ä»¤
- â€¢ Glob \- æ–‡ä»¶æ¨¡å¼åŒ¹é…
- â€¢ Grep \- å†…å®¹æœç´¢
- â€¢ Read \- æ–‡ä»¶è¯»å–
- â€¢ Edit ã€ MultiEdit \- æ–‡ä»¶ç¼–è¾‘
- â€¢ Write \- æ–‡ä»¶å†™å…¥
- â€¢ WebFetch ã€ WebSearch \- Web æ“ä½œ

#### PostToolUse

åœ¨å·¥å…·æˆåŠŸå®Œæˆåç«‹å³è¿è¡Œã€‚

è¯†åˆ«ä¸ PreToolUse ç›¸åŒçš„åŒ¹é…å™¨å€¼ã€‚

#### Notification

å½“ Claude Code å‘é€é€šçŸ¥æ—¶è¿è¡Œã€‚

#### Stop

å½“ Claude Code å®Œæˆå“åº”æ—¶è¿è¡Œã€‚

### Hook è¾“å…¥

Hooks é€šè¿‡ stdin æ¥æ”¶åŒ…å«ä¼šè¯ä¿¡æ¯å’Œäº‹ä»¶ç‰¹å®šæ•°æ®çš„ JSON æ•°æ®ï¼š

```
{
  // é€šç”¨å­—æ®µ
  "session_id" : "string",
  "transcript_path" : "string", // å¯¹è¯ JSON çš„è·¯å¾„
  // äº‹ä»¶ç‰¹å®šå­—æ®µ
  ...
}
```

#### PreToolUse è¾“å…¥

tool\_input çš„ç¡®åˆ‡ schema å–å†³äºå…·ä½“çš„å·¥å…·ã€‚

```
{
  "session_id":"abc123",
"transcript_path":"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl",
"tool_name":"Write",
"tool_input":{
    "file_path":"/path/to/file.txt",
    "content":"file content"
}
}
```

#### PostToolUse è¾“å…¥

tool\_input å’Œ tool\_response çš„ç¡®åˆ‡ schema å–å†³äºå…·ä½“çš„å·¥å…·ã€‚

```
{
  "session_id":"abc123",
"transcript_path":"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl",
"tool_name":"Write",
"tool_input":{
    "file_path":"/path/to/file.txt",
    "content":"file content"
},
"tool_response":{
    "filePath":"/path/to/file.txt",
    "success":true
}
}
```

#### Notification è¾“å…¥

```
{
  "session_id":"abc123",
"transcript_path":"~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl",
"message":"Task completed successfully",
"title":"Claude Code"
}
```

#### Stop è¾“å…¥

å½“ Claude Code å› ä¸ºä¸€ä¸ª Stop Hook çš„ç»“æœè€Œå·²ç»ç»§ç»­è¿è¡Œæ—¶ï¼Œ stop\_hook\_active ä¸º trueã€‚æ£€æŸ¥æ­¤å€¼æˆ–å¤„ç†å¯¹è¯è®°å½•ï¼Œä»¥é˜²æ­¢ Claude Code æ— é™æœŸè¿è¡Œã€‚

```
{
  "session_id" : "abc123",
  "transcript_path" : "~/.claude/projects/.../00893aaf-19fa-41d2-8238-13269b9b3ca0.jsonl",
  "stop_hook_active" : true
}
```

### Hook è¾“å‡º

Hooks æœ‰ä¸¤ç§æ–¹å¼å°†è¾“å‡ºè¿”å›ç»™ Claude Codeã€‚è¾“å‡ºä¼ è¾¾äº†æ˜¯å¦è¦é˜»æ­¢æ“ä½œä»¥åŠåº”å‘ Claude å’Œç”¨æˆ·æ˜¾ç¤ºå“ªäº›åé¦ˆã€‚

#### ç®€å•æ–¹å¼ï¼šé€€å‡ºç  (Exit Code)

Hooks é€šè¿‡é€€å‡ºç ã€stdout å’Œ stderr æ¥é€šä¿¡çŠ¶æ€ï¼š

- â€¢ **é€€å‡ºç  0** ï¼šæˆåŠŸã€‚ stdout åœ¨ transcript æ¨¡å¼ï¼ˆCTRL-Rï¼‰ä¸‹æ˜¾ç¤ºç»™ç”¨æˆ·ã€‚
- â€¢ **é€€å‡ºç  2** ï¼šé˜»å¡æ€§é”™è¯¯ã€‚ stderr ä¼šè¢«åé¦ˆç»™ Claude ä»¥è‡ªåŠ¨å¤„ç†ã€‚è¯·å‚é˜…ä¸‹é¢æ¯ä¸ª Hook äº‹ä»¶çš„è¡Œä¸ºã€‚
- â€¢ **å…¶ä»–é€€å‡ºç ** ï¼šéé˜»å¡æ€§é”™è¯¯ã€‚ stderr æ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œæ‰§è¡Œç»§ç»­ã€‚

#### é€€å‡ºç  2 çš„è¡Œä¸º

| Hook äº‹ä»¶ | è¡Œä¸º |
| --- | --- |
| PreToolUse | é˜»æ­¢å·¥å…·è°ƒç”¨ï¼Œå‘ Claude æ˜¾ç¤ºé”™è¯¯ |
| PostToolUse | å‘ Claude æ˜¾ç¤ºé”™è¯¯ï¼ˆå·¥å…·å·²è¿è¡Œï¼‰ |
| Notification | ä¸é€‚ç”¨ï¼Œä»…å‘ç”¨æˆ·æ˜¾ç¤º stderr |
| Stop | é˜»æ­¢åœæ­¢ï¼Œå‘ Claude æ˜¾ç¤ºé”™è¯¯ |

#### é«˜çº§æ–¹å¼ï¼šJSON è¾“å‡º

Hooks å¯ä»¥åœ¨ stdout ä¸­è¿”å›ç»“æ„åŒ–çš„ JSONï¼Œä»¥å®ç°æ›´å¤æ‚çš„æ§åˆ¶ï¼š

##### é€šç”¨ JSON å­—æ®µ

æ‰€æœ‰ Hook ç±»å‹éƒ½å¯ä»¥åŒ…å«è¿™äº›å¯é€‰å­—æ®µï¼š

```
{
  "continue" : true,          // Hook æ‰§è¡Œå Claude æ˜¯å¦åº”ç»§ç»­ï¼ˆé»˜è®¤ä¸º trueï¼‰
  "stopReason" : "string",    // å½“ continue ä¸º false æ—¶æ˜¾ç¤ºçš„æ¶ˆæ¯
  "suppressOutput" : true     // ä» transcript æ¨¡å¼ä¸­éšè— stdoutï¼ˆé»˜è®¤ä¸º falseï¼‰
}
```

å¦‚æœ `continue` ä¸º `false` ï¼ŒClaude åœ¨ Hooks è¿è¡Œååœæ­¢å¤„ç†ã€‚

- â€¢ å¯¹äº PreToolUse ï¼Œè¿™ä¸ `"decision": "block"` ä¸åŒï¼Œåè€…åªé˜»æ­¢ç‰¹å®šçš„å·¥å…·è°ƒç”¨å¹¶å‘ Claude æä¾›è‡ªåŠ¨åé¦ˆã€‚
- â€¢ å¯¹äº PostToolUse ï¼Œè¿™ä¸ `"decision": "block"` ä¸åŒï¼Œåè€…å‘ Claude æä¾›è‡ªåŠ¨åé¦ˆã€‚
- â€¢ å¯¹äº Stop ï¼Œå®ƒä¼˜å…ˆäºä»»ä½• `"decision": "block"` è¾“å‡ºã€‚
- â€¢ åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œ `"continue": false` ä¼˜å…ˆäºä»»ä½• `"decision": "block"` è¾“å‡ºã€‚

`stopReason` ä¼´éš `continue` ä¸€èµ·ä½¿ç”¨ï¼Œå‘ç”¨æˆ·æ˜¾ç¤ºä¸€ä¸ªåŸå› ï¼Œä½†ä¸ä¼šæ˜¾ç¤ºç»™ Claudeã€‚

#### PreToolUse å†³ç­–æ§åˆ¶

PreToolUse Hooks å¯ä»¥æ§åˆ¶å·¥å…·è°ƒç”¨æ˜¯å¦ç»§ç»­ã€‚

- â€¢ **â€œapproveâ€** ç»•è¿‡æƒé™ç³»ç»Ÿã€‚ reason æ˜¾ç¤ºç»™ç”¨æˆ·ï¼Œä½†ä¸æ˜¾ç¤ºç»™ Claudeã€‚
- â€¢ **â€œblockâ€** é˜»æ­¢å·¥å…·è°ƒç”¨æ‰§è¡Œã€‚ reason æ˜¾ç¤ºç»™ Claudeã€‚
- â€¢ **`undefined`** (æœªå®šä¹‰) ä¼šè¿›å…¥ç°æœ‰çš„æƒé™æµç¨‹ã€‚ reason è¢«å¿½ç•¥ã€‚
```
{
  "decision" : "approve" | "block" | undefined,
  "reason" : "å†³ç­–çš„è§£é‡Š"
}
```

#### PostToolUse å†³ç­–æ§åˆ¶

PostToolUse Hooks å¯ä»¥æ§åˆ¶å·¥å…·è°ƒç”¨æ˜¯å¦ç»§ç»­ã€‚

- â€¢ **â€œblockâ€** ä¼šè‡ªåŠ¨ç”¨ reason æç¤º Claudeã€‚
- â€¢ **`undefined`** (æœªå®šä¹‰) ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ reason è¢«å¿½ç•¥ã€‚
```
{
  "decision" : "block" | undefined,
  "reason" : "å†³ç­–çš„è§£é‡Š"
}
```

#### Stop å†³ç­–æ§åˆ¶

Stop Hooks å¯ä»¥æ§åˆ¶ Claude æ˜¯å¦å¿…é¡»ç»§ç»­ã€‚

- â€¢ **â€œblockâ€** é˜»æ­¢ Claude åœæ­¢ã€‚ä½ å¿…é¡»å¡«å…… reason ä»¥ä¾¿ Claude çŸ¥é“å¦‚ä½•ç»§ç»­ã€‚
- â€¢ **`undefined`** (æœªå®šä¹‰) å…è®¸ Claude åœæ­¢ã€‚ reason è¢«å¿½ç•¥ã€‚
```
{
  "decision" : "block" | undefined,
  "reason" : "å½“ Claude è¢«é˜»æ­¢åœæ­¢æ—¶å¿…é¡»æä¾›"
}
```

### ä½¿ç”¨ MCP å·¥å…·

Claude Code Hooks ä¸ æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰å·¥å…· <sup><span>[4]</span></sup> æ— ç¼åä½œã€‚å½“ MCP æœåŠ¡å™¨æä¾›å·¥å…·æ—¶ï¼Œå®ƒä»¬ä¼šä»¥ä¸€ç§ç‰¹æ®Šçš„å‘½åæ¨¡å¼å‡ºç°ï¼Œä½ å¯ä»¥åœ¨ Hooks ä¸­åŒ¹é…è¿™ç§æ¨¡å¼ã€‚

#### MCP å·¥å…·å‘½å

MCP å·¥å…·éµå¾ª mcp\_\_<server>\_\_<tool> çš„æ¨¡å¼ï¼Œä¾‹å¦‚ï¼š

- â€¢ mcp\_\_memory\_\_create\_entities \- Memory æœåŠ¡å™¨çš„åˆ›å»ºå®ä½“å·¥å…·
- â€¢ mcp\_\_filesystem\_\_read\_file \- Filesystem æœåŠ¡å™¨çš„è¯»å–æ–‡ä»¶å·¥å…·
- â€¢ mcp\_\_github\_\_search\_repositories \- GitHub æœåŠ¡å™¨çš„æœç´¢å·¥å…·

#### ä¸º MCP å·¥å…·é…ç½® Hooks

ä½ å¯ä»¥é’ˆå¯¹ç‰¹å®šçš„ MCP å·¥å…·æˆ–æ•´ä¸ª MCP æœåŠ¡å™¨ï¼š

```
{
  "hooks":{
    "PreToolUse":[
      {
        "matcher":"mcp__memory__.*",
        "hooks":[
          {
            "type":"command",
            "command":"echo 'Memory operation initiated' >> ~/mcp-operations.log"
          }
        ]
      },
      {
        "matcher":"mcp__.*__write.*",
        "hooks":[
          {
            "type":"command",
            "command":"/home/user/scripts/validate-mcp-write.py"
          }
        ]
      }
    ]
}
}
```

### ç¤ºä¾‹

#### ä»£ç æ ¼å¼åŒ–

åœ¨æ–‡ä»¶ä¿®æ”¹åè‡ªåŠ¨æ ¼å¼åŒ–ä»£ç ï¼š

```
{
  "hooks":{
    "PostToolUse":[
      {
        "matcher":"Write|Edit|MultiEdit",
        "hooks":[
          {
            "type":"command",
            "command":"/home/user/scripts/format-code.sh"
          }
        ]
      }
    ]
}
}
```

#### é€šçŸ¥

è‡ªå®šä¹‰å½“ Claude Code è¯·æ±‚æƒé™æˆ–å½“æç¤ºè¾“å…¥å˜ä¸ºç©ºé—²æ—¶å‘é€çš„é€šçŸ¥ã€‚

```
{
  "hooks":{
    "Notification":[
      {
        "matcher":"",
        "hooks":[
          {
            "type":"command",
            "command":"python3 ~/my_custom_notifier.py"
          }
        ]
      }
    ]
}
}
```

### å®‰å…¨æ³¨æ„äº‹é¡¹

#### å…è´£å£°æ˜

**ä½¿ç”¨é£é™©è‡ªè´Ÿ** ï¼šClaude Code Hooks ä¼šåœ¨ä½ çš„ç³»ç»Ÿä¸Šè‡ªåŠ¨æ‰§è¡Œä»»æ„ shell å‘½ä»¤ã€‚ä½¿ç”¨ Hooks å³è¡¨ç¤ºä½ æ‰¿è®¤ï¼š

- â€¢ ä½ å¯¹è‡ªå·±é…ç½®çš„å‘½ä»¤è´Ÿå…¨éƒ¨è´£ä»»ã€‚
- â€¢ Hooks å¯ä»¥ä¿®æ”¹ã€åˆ é™¤æˆ–è®¿é—®ä½ çš„ç”¨æˆ·å¸æˆ·å¯ä»¥è®¿é—®çš„ä»»ä½•æ–‡ä»¶ã€‚
- â€¢ æ¶æ„çš„æˆ–ç¼–å†™ä¸ä½³çš„ Hooks å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–ç³»ç»ŸæŸåã€‚
- â€¢ Anthropic ä¸æä¾›ä»»ä½•ä¿è¯ï¼Œä¹Ÿä¸å¯¹å› ä½¿ç”¨ Hooks é€ æˆçš„ä»»ä½•æŸå®³æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚
- â€¢ åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ä¹‹å‰ï¼Œä½ åº”åœ¨å®‰å…¨çš„ç¯å¢ƒä¸­å½»åº•æµ‹è¯• Hooksã€‚

åœ¨å°†ä»»ä½• Hook å‘½ä»¤æ·»åŠ åˆ°ä½ çš„é…ç½®ä¹‹å‰ï¼Œè¯·åŠ¡å¿…å®¡æŸ¥å’Œç†è§£å®ƒä»¬ã€‚

#### å®‰å…¨æœ€ä½³å®è·µ

ä»¥ä¸‹æ˜¯ç¼–å†™æ›´å®‰å…¨ Hooks çš„ä¸€äº›å…³é”®å®è·µï¼š

1. 1\. **éªŒè¯å’Œå‡€åŒ–è¾“å…¥** \- æ°¸è¿œä¸è¦ç›²ç›®ä¿¡ä»»è¾“å…¥æ•°æ®ã€‚
2. 2\. **å§‹ç»ˆå¼•ç”¨ shell å˜é‡** \- ä½¿ç”¨ "$VAR" è€Œä¸æ˜¯ $VAR ã€‚
3. 3\. **é˜»æ­¢è·¯å¾„éå†** \- æ£€æŸ¥æ–‡ä»¶è·¯å¾„ä¸­çš„ ..ã€‚
4. 4\. **ä½¿ç”¨ç»å¯¹è·¯å¾„** \- ä¸ºè„šæœ¬æŒ‡å®šå®Œæ•´è·¯å¾„ã€‚
5. 5\. **è·³è¿‡æ•æ„Ÿæ–‡ä»¶** \- é¿å… .env ã€.git/ ã€å¯†é’¥ç­‰ã€‚

#### Hook æ‰§è¡Œè¯¦æƒ…

- â€¢ **è¶…æ—¶** ï¼š60 ç§’æ‰§è¡Œé™åˆ¶ã€‚
- â€¢ **å¹¶è¡ŒåŒ–** ï¼šæ‰€æœ‰åŒ¹é…çš„ Hooks å¹¶è¡Œè¿è¡Œã€‚
- â€¢ **ç¯å¢ƒ** ï¼šåœ¨å½“å‰ç›®å½•ä¸­ä»¥ Claude Code çš„ç¯å¢ƒè¿è¡Œã€‚
- â€¢ **è¾“å…¥** ï¼šé€šè¿‡ stdin ä¼ å…¥ JSONã€‚
- â€¢ **è¾“å‡º** ï¼š
- â€¢ PreToolUse/PostToolUse/Stopï¼šè¿›åº¦æ˜¾ç¤ºåœ¨ transcript (Ctrl-R) ä¸­ã€‚
	- â€¢ Notificationï¼šä»…è®°å½•åˆ°è°ƒè¯•æ—¥å¿— (\--debug)ã€‚

#### è°ƒè¯•

è¦å¯¹ Hooks è¿›è¡Œæ•…éšœæ’é™¤ï¼š

1. 1\. æ£€æŸ¥ **/hooks** èœå•æ˜¯å¦æ˜¾ç¤ºä½ çš„é…ç½®ã€‚
2. 2\. éªŒè¯ä½ çš„ è®¾ç½®æ–‡ä»¶ <sup><span>[5]</span></sup> æ˜¯æœ‰æ•ˆçš„ JSONã€‚
3. 3\. æ‰‹åŠ¨æµ‹è¯•å‘½ä»¤ã€‚
4. 4\. æ£€æŸ¥é€€å‡ºç ã€‚
5. 5\. å®¡æŸ¥ stdout å’Œ stderr çš„æ ¼å¼æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚
6. 6\. ç¡®ä¿æ­£ç¡®è½¬ä¹‰å¼•å·ã€‚

è¿›åº¦æ¶ˆæ¯ä¼šå‡ºç°åœ¨ transcript æ¨¡å¼ï¼ˆCtrl-Rï¼‰ä¸­ï¼Œæ˜¾ç¤ºï¼š

- â€¢ å“ªä¸ª Hook æ­£åœ¨è¿è¡Œ
- â€¢ æ­£åœ¨æ‰§è¡Œçš„å‘½ä»¤
- â€¢ æˆåŠŸ/å¤±è´¥çŠ¶æ€
- â€¢ è¾“å‡ºæˆ–é”™è¯¯æ¶ˆæ¯

## 2\. ç¼–ç ä¸­ä½¿ç”¨Hookçš„ç®€å•æ¡ˆä¾‹

- â€¢ è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç 
- â€¢ è‡ªå®šä¹‰é€šçŸ¥
- â€¢ éªŒè¯è¾“å…¥
- â€¢ æ‰§è¡Œå¤–éƒ¨è„šæœ¬
- â€¢ ä¸å¤–éƒ¨ç³»ç»Ÿé›†æˆ
- â€¢ è°ƒè¯•å’Œæ—¥å¿—è®°å½•
- â€¢ è‡ªåŠ¨åŒ–æµ‹è¯•å’Œ CI/CD
- â€¢ æ•°æ®å¤„ç†å’Œè½¬æ¢
- â€¢ ä»£ç åˆ†æå’Œè´¨é‡ä¿è¯
- â€¢ ä»£ç ç”Ÿæˆ
- â€¢ ä»£ç è¡¥å…¨
- â€¢ ä»£ç è§£é‡Š
- â€¢ ä»£ç è°ƒè¯•
- â€¢ ä»£ç é‡æ„

æ¦‚æ‹¬ä¸€ä¸‹å¤§æ¦‚åŒ…æ‹¬ç¼–ç è§„èŒƒ/å¥‘çº¦ã€è´¨é‡é—¨ç¦ã€CI/CDã€ç¯å¢ƒæ ‡å‡†åŒ–ä¸æœ¬åœ°åŒ–ã€ä¸Šä¸‹æ–‡åŠ¨æ€æ„ŸçŸ¥ç­‰ã€‚ä»¥ä¸Šè¿™äº›æ˜¯Hooksæœ€æ ¸å¿ƒã€æœ€ç»å…¸çš„åº”ç”¨åœºæ™¯ã€‚ç›®æ ‡æ˜¯è®©LLMè¾“å‡ºçš„ä»£ç åœ¨æ— éœ€äººå·¥å¹²é¢„çš„æƒ…å†µä¸‹ï¼Œå°±èƒ½ç¬¦åˆå›¢é˜Ÿè§„èŒƒã€‚

### ä»£ç å®‰å…¨æ£€æŸ¥ä¸è´¨é‡é—¨ç¦

- â€¢ é˜²æ•æ„Ÿä¿¡æ¯æ³„éœ²:
- â€¢ Hookäº‹ä»¶: PreToolUse
	- â€¢ åŒ¹é…å™¨: Write|Edit|MultiEdit
	- â€¢ åŠ¨ä½œ: Hook è„šæœ¬æ¥æ”¶åˆ°å°†è¦å†™å…¥æ–‡ä»¶çš„å†…å®¹ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æˆ–æ›´é«˜çº§çš„æ‰«æå·¥å…·ï¼ˆå¦‚ gitleaks çš„åº“ï¼‰å®æ—¶æ‰«æå†…å®¹ä¸­æ˜¯å¦åŒ…å« API Keysã€æ•°æ®åº“å¯†ç ã€ç§é’¥ç­‰å¸¸è§æ•æ„Ÿä¿¡æ¯æ ¼å¼ã€‚
	- â€¢ åé¦ˆ: ä¸€æ—¦å‘ç°ï¼Œç«‹å³è¿”å› é€€å‡ºç 2 æˆ– {"decision": "block",...}ï¼Œå¹¶å‘ Claude æä¾›æ˜ç¡®çš„åé¦ˆï¼š"å®‰å…¨ç­–ç•¥å†²çªï¼šæ£€æµ‹åˆ°æ‚¨æ­£å°è¯•å°†APIå¯†é’¥ç¡¬ç¼–ç å†™å…¥æ–‡ä»¶ã€‚è¯·æ”¹ç”¨ç¯å¢ƒå˜é‡æˆ–å…¬å¸æŒ‡å®šçš„å¯†é’¥ç®¡ç†æœåŠ¡ã€‚æ“ä½œå·²é˜»æ­¢ã€‚" è¿™ä¸ä»…é˜»æ­¢äº†å±é™©æ“ä½œï¼Œè¿˜å¯¹ LLM è¿›è¡Œäº†â€œå†æ•™è‚²â€ã€‚
- â€¢ ç”Ÿäº§ç¯å¢ƒâ€œåªè¯»â€æ¨¡å¼:
- â€¢ Hookäº‹ä»¶: PreToolUse
	- â€¢ åŒ¹é…å™¨: Write|Edit|MultiEdit|Bash
	- â€¢ åŠ¨ä½œ: Hook è„šæœ¬æ£€æŸ¥å½“å‰ Git åˆ†æ”¯ã€‚å¦‚æœåˆ†æ”¯æ˜¯ main/master æˆ– production/tagï¼Œåˆ™ç«‹å³é˜»æ­¢ä»»ä½•æ–‡ä»¶å†™å…¥æˆ–åˆ é™¤ (rm) å‘½ä»¤ã€‚
	- â€¢ åé¦ˆ: "æ“ä½œå·²é˜»æ­¢ã€‚å½“å‰å¤„äºç”Ÿäº§åˆ†æ”¯ï¼Œä¸å…è®¸ç›´æ¥ä¿®æ”¹ã€‚å¦‚éœ€æ›´æ”¹ï¼Œè¯·åˆ›å»ºæ–°çš„ç‰¹æ€§åˆ†æ”¯ã€‚"

### åŠ¨æ€ç®¡ç†å¼€å‘ç¯å¢ƒ

- â€¢ ä¾èµ–è‡ªåŠ¨å®‰è£…:
- â€¢ Hookäº‹ä»¶: PreToolUse
	- â€¢ åŒ¹é…å™¨: Bash
	- â€¢ åŠ¨ä½œ: Hook è„šæœ¬è§£æ Claude æƒ³è¦æ‰§è¡Œçš„ commandã€‚å¦‚æœå‘½ä»¤æ˜¯ npm start æˆ– python app.pyï¼Œè„šæœ¬ä¼šå…ˆè®¡ç®— package.json æˆ– requirements.txt çš„å“ˆå¸Œå€¼ï¼Œå¹¶ä¸ä¸Šæ¬¡æˆåŠŸå®‰è£…æ—¶çš„å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœä¸ä¸€è‡´ï¼Œå®ƒä¼šå…ˆäº Claude çš„å‘½ä»¤è‡ªåŠ¨è¿è¡Œ npm install æˆ– pip install -r requirements.txtï¼Œç„¶åå†è®©åŸå§‹å‘½ä»¤ç»§ç»­ã€‚
	- â€¢ åé¦ˆ: æ— éœ€é˜»å¡ï¼Œåªéœ€åœ¨ transcript ä¸­æ‰“å°ä¸€æ¡ä¿¡æ¯ï¼š"æ£€æµ‹åˆ°ä¾èµ–é¡¹å˜æ›´ï¼Œå·²è‡ªåŠ¨ä¸ºæ‚¨æ‰§è¡Œ pip installã€‚"

### äº¤äº’å¼ä»£ç å®¡æŸ¥ä¸é™æ€åˆ†æ

- â€¢ ä»£ç å®¡æŸ¥:
- â€¢ Hookäº‹ä»¶: PostToolUse
	- â€¢ åŒ¹é…å™¨: Write|Edit
	- â€¢ åŠ¨ä½œ: å½“ Claude ä¿®æ”¹äº†ä¸€ä¸ªå‡½æ•°åï¼ŒHook å¯ä»¥å°†è¿™ä¸ªå‡½æ•°çš„ä»£ç ç‰‡æ®µå‘é€åˆ°å¦ä¸€ä¸ª LLM APIï¼ˆç”šè‡³æ˜¯ Claude è‡ªèº«çš„ä¸€ä¸ªæ–°å®ä¾‹ï¼‰ï¼Œå¹¶é™„ä¸Šä¸€ä¸ªç‰¹æ®Šæç¤ºï¼šâ€œè¯·ä¸ºä»¥ä¸‹å‡½æ•°ç¼–å†™å•å…ƒæµ‹è¯•ã€‚â€ ç„¶åï¼ŒHook å°†è¿”å›çš„æµ‹è¯•ä»£ç å†™å…¥æµ‹è¯•æ–‡ä»¶ï¼Œå¹¶ç«‹å³è¿è¡Œæµ‹è¯•ã€‚
	- â€¢ åé¦ˆ: å‘ Claude æŠ¥å‘Šæµ‹è¯•ç»“æœï¼šâ€œæˆ‘å·²ä¸ºæ‚¨åˆšæ‰ä¿®æ”¹çš„å‡½æ•°è‡ªåŠ¨ç”Ÿæˆå¹¶è¿è¡Œäº†3ä¸ªå•å…ƒæµ‹è¯•ï¼Œå…¨éƒ¨é€šè¿‡ã€‚å¹²å¾—æ¼‚äº®ï¼â€ æˆ–è€… â€œå•å…ƒæµ‹è¯•å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š...ï¼Œè¯·ä¿®å¤æ‚¨åˆšæ‰çš„ä»£ç ã€‚â€
- â€¢ å¤æ‚ä»£ç è§„èŒƒæ‰§è¡Œå™¨:
- â€¢ Hookäº‹ä»¶: PostToolUse
	- â€¢ åŒ¹é…å™¨: Write|Edit
	- â€¢ åŠ¨ä½œ: ä¸ä»…ä»…æ˜¯ Prettier/Gofmt è¿™ç±»æ ¼å¼åŒ–å·¥å…·ã€‚Hook å¯ä»¥åœ¨ Claude å†™å®Œä»£ç åï¼Œè¿è¡Œä¸€ä¸ªå®Œæ•´çš„é™æ€åˆ†æå¥—ä»¶ï¼ˆå¦‚ SonarLint, ESLint with custom rulesï¼‰ã€‚å®ƒå¯ä»¥æ£€æŸ¥åœˆå¤æ‚åº¦ã€ä»£ç å¼‚å‘³ã€åæ¨¡å¼ç­‰ã€‚
	- â€¢ åé¦ˆ: å®ƒä¼šè§£æ Linter çš„è¾“å‡ºï¼Œå¹¶ä»¥éå¸¸äººæ€§åŒ–çš„æ–¹å¼åé¦ˆç»™ Claudeï¼š{"decision": "block", "reason": "ä»£ç å®¡æŸ¥å‘ç°å‡ ä¸ªé—®é¢˜ï¼š1. 'calculate\_price' å‡½æ•°çš„åœˆå¤æ‚åº¦ä¸º15ï¼ˆå»ºè®®ä½äº10ï¼‰ï¼Œè¯·å°è¯•é‡æ„ã€‚2. æ£€æµ‹åˆ°åœ¨å¾ªç¯ä¸­è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚è¯·ä¼˜åŒ–ã€‚"}

### æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆä¸æ‰§è¡Œ:

- â€¢ Hookäº‹ä»¶: PostToolUse
- â€¢ åŒ¹é…å™¨: Write|Edit
- â€¢ åŠ¨ä½œ: å½“ Claude ä¿®æ”¹äº†ä¸€ä¸ªå‡½æ•°åï¼ŒHook å¯ä»¥å°†è¿™ä¸ªå‡½æ•°çš„ä»£ç ç‰‡æ®µå‘é€åˆ°å¦ä¸€ä¸ª LLM APIï¼ˆç”šè‡³æ˜¯ Claude è‡ªèº«çš„ä¸€ä¸ªæ–°å®ä¾‹ï¼‰ï¼Œå¹¶é™„ä¸Šä¸€ä¸ªç‰¹æ®Šæç¤ºï¼šâ€œè¯·ä¸ºä»¥ä¸‹å‡½æ•°ç¼–å†™å•å…ƒæµ‹è¯•ã€‚â€ ç„¶åï¼ŒHook å°†è¿”å›çš„æµ‹è¯•ä»£ç å†™å…¥æµ‹è¯•æ–‡ä»¶ï¼Œå¹¶ç«‹å³è¿è¡Œæµ‹è¯•ã€‚
- â€¢ åé¦ˆ: å‘ Claude æŠ¥å‘Šæµ‹è¯•ç»“æœï¼šâ€œæˆ‘å·²ä¸ºæ‚¨åˆšæ‰ä¿®æ”¹çš„å‡½æ•°è‡ªåŠ¨ç”Ÿæˆå¹¶è¿è¡Œäº†3ä¸ªå•å…ƒæµ‹è¯•ï¼Œå…¨éƒ¨é€šè¿‡ã€‚å¹²å¾—æ¼‚äº®ï¼â€ æˆ–è€… â€œå•å…ƒæµ‹è¯•å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š...ï¼Œè¯·ä¿®å¤æ‚¨åˆšæ‰çš„ä»£ç ã€‚â€

### è‡ªåŠ¨åŒ–ä¸å·¥ä½œæµ

ä¸åŒäºä¸AIå¯¹è¯ï¼Œæ­¤å¤„çš„è‡ªåŠ¨åŒ–ä¸å·¥ä½œæµæ˜¯ç¡®å®šæ€§çš„ã€ç”Ÿäº§å¯ç”¨çš„ã€‚

- â€¢ Git æäº¤ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆ:
- â€¢ Hookäº‹ä»¶: Stop
	- â€¢ åŒ¹é…å™¨: (æ— ï¼Œå…¨å±€)
- â€¢ ä¸é¡¹ç›®ç®¡ç†å·¥å…·è”åŠ¨:
- â€¢ Hookäº‹ä»¶: Stop
	- â€¢ åŒ¹é…å™¨: (æ— ï¼Œå…¨å±€)
	- â€¢ åŠ¨ä½œ: ä¸ä¸Šä¸€ä¸ªç±»ä¼¼ï¼Œå½“ä»»åŠ¡å®Œæˆæ—¶ï¼ŒHook ä¸ä»…æäº¤ä»£ç ï¼Œè¿˜ä¼šä» Git åˆ†æ”¯åæˆ–æäº¤ä¿¡æ¯ä¸­è§£æå‡º Jira Ticket IDï¼ˆå¦‚ PROJ-123ï¼‰ï¼Œç„¶åè°ƒç”¨ Jira APIï¼Œè‡ªåŠ¨å°†è¿™å¼ ç¥¨æ®çš„çŠ¶æ€ä» "In Progress" æ›´æ–°ä¸º "In Review"ï¼Œå¹¶é™„ä¸Šä¸€æ¡è¯„è®ºï¼šâ€œClaude å·²å®Œæˆåˆå§‹å®ç°ï¼Œä»£ç å·²æäº¤ã€‚@å¼ ä¸‰ è¯·è¿›è¡Œä»£ç å®¡æŸ¥ã€‚â€

## å…·ä½“ä»£ç ç¤ºä¾‹

```
"hooks":{
    "PreToolUse":[
      {
        "matcher":"Write|Edit|MultiEdit",
        "hooks":[
          {
            "type":"command",
            "command":"python3 ~/.claude/scripts/claude_checker.py --strategy security"
          },
          {
            "type":"command",
            "command":"python3 ~/.claude/scripts/claude_checker.py --strategy sensitive"
          },
          {
            "type":"command",
            "command":"python3 ~/.claude/scripts/claude_checker.py --strategy lint"
          },
          {
            "type":"command",
            "command":"python3 ~/.claude/scripts/claude_checker.py --strategy rules"
          }
        ]
      }
    ],
    "PostToolUse":[
      {
        "matcher":"Write|Edit|MultiEdit",
        "hooks":[
          {
            "type":"command",
            "command":"python3 ~/.claude/scripts/claude_checker.py --strategy format"
          }
        ]
      }
    ],
    "Notification":[
      {
        "matcher":"",
        "hooks":[
          {
            "type":"command",
            "command":"python3 ~/.claude/scripts/log_rotator.py --type notification"
          }
        ]
      }
    ]
  }
```
```
# æ•æ„Ÿä¿¡æ¯æ¨¡å¼ - åŸºäºå¸¸è§çš„æ•æ„Ÿä¿¡æ¯æ ¼å¼
    SENSITIVE_PATTERNS = [
        # APIå¯†é’¥å’Œä»¤ç‰Œ
        (r'(?i)(api[_-]?key|secret[_-]?key|access[_-]?token)\s*[=:]\s*["\']([a-zA-Z0-9_-]{20,})["\']', 'APIå¯†é’¥/ä»¤ç‰Œå¯èƒ½æ³„éœ²'),
        (r'(?i)(password|passwd|pwd)\s*[=:]\s*["\']([^"\']{8,})["\']', 'å¯†ç å¯èƒ½ç¡¬ç¼–ç '),
        
        # AWSè®¿é—®å¯†é’¥
        (r'AKIA[0-9A-Z]{16}', 'AWSè®¿é—®å¯†é’¥æ³„éœ²'),
        (r'(?i)aws[_-]?secret[_-]?access[_-]?key.*["\']([a-zA-Z0-9/+=]{40})["\']', 'AWSå¯†é’¥æ³„éœ²'),
        
        # æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
        (r'(?i)(mysql|postgresql|mongodb)://[^:]+:[^@]+@', 'æ•°æ®åº“è¿æ¥åŒ…å«å‡­æ®'),
        
        # ç§é’¥
        (r'-----BEGIN\s+(RSA\s+)?PRIVATE\s+KEY-----', 'ç§é’¥æ–‡ä»¶å†…å®¹'),
        
        # JWTä»¤ç‰Œ
        (r'ey[A-Za-z0-9_-]*\.ey[A-Za-z0-9_-]*\.[A-Za-z0-9_-]*', 'JWTä»¤ç‰Œå¯èƒ½æ³„éœ²'),
        
        # GitHubä»¤ç‰Œ
        (r'gh[pousr]_[A-Za-z0-9_]{36,}', 'GitHubä»¤ç‰Œæ³„éœ²'),
        
        # IPåœ°å€ï¼ˆå†…ç½‘ï¼‰
        (r'(?:10\.|172\.(?:1[6-9]|2[0-9]|3[01])\.|192\.168\.)\d{1,3}\.\d{1,3}', 'å†…ç½‘IPåœ°å€æ³„éœ²'),
        
        # ç”µå­é‚®ä»¶åœ°å€æ¨¡å¼ï¼ˆå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰
        (r'[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}(?=.*(?:admin|root|test|dev))', 'æ•æ„Ÿé‚®ç®±åœ°å€'),
    ]
```

è‡³äºå…·ä½“çš„pythonæ–‡ä»¶å¦‚ä½•å†™ï¼Œå°±çœ‹è‡ªå·±çš„å®é™…éœ€è¦äº†ã€‚

è¿è¡Œç»“æœï¼š

![å›¾ç‰‡](https://mp.weixin.qq.com/s/www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg%20stroke='none'%20stroke-width='1'%20fill='none'%20fill-rule='evenodd'%20fill-opacity='0'%3E%3Cg%20transform='translate(-249.000000,%20-126.000000)'%20fill='%23FFFFFF'%3E%3Crect%20x='249'%20y='126'%20width='1'%20height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

ğŸ”¥æ¨èé˜…è¯»

[DeepSeek R2å› èŠ¯ç‰‡çŸ­ç¼ºè€Œå»¶è¿Ÿå‘å¸ƒ](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485398&idx=1&sn=4bbfc60c627ae1fa0ffad209504fa004&scene=21#wechat_redirect)

[è°·æ­Œè¯´æœ OpenAI ä½¿ç”¨ TPU èŠ¯ç‰‡](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485393&idx=1&sn=fb1c1e99834e47db8360f029993c35a2&scene=21#wechat_redirect)

[Claudeè‡ªä¸»ç»è¥ä¸€å®¶å°åº—ï¼Œæ›¾è®¤ä¸ºè‡ªå·±æ˜¯çœŸäºº](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485387&idx=1&sn=f3b5f84612dfe43892a0db4694123211&scene=21#wechat_redirect)

[è°·æ­Œæ¨å‡ºå…è´¹ã€å¼€æºçš„Gemini CLI](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485377&idx=1&sn=2718b0ac39e0611764e846582d8adb92&scene=21#wechat_redirect)

[AKæœ€æ–°æ¼”è®²ï¼šæˆ‘ä»¬å¤„äºè½¯ä»¶3.0æ—¶ä»£](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485221&idx=1&sn=c3943017566bc03984351d8578a8bd7f&scene=21#wechat_redirect)

[â€œAI-Readyâ€æ˜¯AIææ•ˆå’Œè½¬å‹çš„å‰æ](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485178&idx=1&sn=53e69c655d4c587211e69a774ac2c4fd&scene=21#wechat_redirect)

[Anthropicï¼šå¤šAgentç³»ç»Ÿæ¯”å•Agentå¾—åˆ†é«˜90%](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485136&idx=1&sn=edb797ad4ef690562b881cd8bbe11757&scene=21#wechat_redirect)

[OpenAIå±±å§†Â·å¥¥ç‰¹æ›¼ï¼šAIå¥‡ç‚¹å·²è‡³](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485083&idx=1&sn=fcdaaacee885cae36bec077fcc7b6aeb&scene=21#wechat_redirect)

[ä¼Šåˆ©äºšæœ€æ–°æ¼”è®²ï¼šAIæ˜¯äººç±»æœ€å¤§çš„æŒ‘æˆ˜](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485061&idx=1&sn=7018f996cba2d09772770bd43628faf3&scene=21#wechat_redirect)

[AIåŸç”Ÿæ—¶ä»£ï¼ŒGUIè½¬å‘â€œæ–‡æœ¬ä¼˜å…ˆâ€çš„æŠ€æœ¯å¿…ç„¶æ€§](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485057&idx=1&sn=0ab49a9bd4f3ffbd7843acd4953a8636&scene=21#wechat_redirect)

[OpenAIå…³äºäººæœºå…³ç³»çš„æ€è€ƒä¸å®è·µ](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485050&idx=1&sn=39268c00e593081927fe3ddbc7f39be8&scene=21#wechat_redirect)

[ä¸è¦åˆ»èˆŸæ±‚å‰‘ï¼Œå…³äºVibe Codingçš„å‡ ç‚¹æ„Ÿæƒ³](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247485006&idx=1&sn=19ff3c6bd200d6f94a82f695ae93864b&scene=21#wechat_redirect)

[å†™ä½œå³æ€è€ƒï¼ŒYCåˆ›å§‹äººå¯¹â€œå¥½æ–‡ç¬”â€çš„æ€è€ƒ](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484970&idx=1&sn=aa7e6f1238632ee4b1b6d74ce0091232&scene=21#wechat_redirect)

[Vibe Codingæœ€ä½³å®è·µï¼šWindsurfçš„è§„åˆ™æœºåˆ¶](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484900&idx=1&sn=b44cd64e66022d6f066d29ca757e4388&scene=21#wechat_redirect)

[Vibe Codingæœ€ä½³å®è·µï¼šCursorçš„è§„åˆ™è§£æ](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484882&idx=1&sn=b261f51adb1d017f26297f07622efda9&scene=21#wechat_redirect)

[AIçš„ä¸‹åŠåœºï¼šä»è§£å†³é—®é¢˜åˆ°å®šä¹‰é—®é¢˜](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484717&idx=1&sn=cadcd05afb486c704963dc4ee95001c6&scene=21#wechat_redirect)

[è°·æ­Œï¼šæ¬¢è¿æ¥åˆ°AIçš„ç»éªŒæ—¶ä»£](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484692&idx=1&sn=3a05eec5ea6c9af31c3f4b2db0ea7a4a&scene=21#wechat_redirect)

[æ·±åº¦åˆ†æGoogle ADK vs OpenAI SDK](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484664&idx=1&sn=26df25a9087c1916a323cc35601d581b&scene=21#wechat_redirect)

[æ²¡æœ‰promptï¼Œä¸€åˆ‡éƒ½æ˜¯ä¸Šä¸‹æ–‡ï¼Ÿ](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484523&idx=1&sn=7497623fb31fc384ba76ec36f3c1b314&scene=21#wechat_redirect)

[ã€Œæ¨¡å‹å³äº§å“ã€æˆç«‹å—ï¼Ÿ](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484437&idx=1&sn=7a64025b677cc97281dec38f6ee77031&scene=21#wechat_redirect)

[å¦‚ä½•ç”¨å¥½AIå¤§æ¨¡å‹ï¼šè‹æ ¼æ‹‰åº•å¼æé—®æ³•](https://mp.weixin.qq.com/s?__biz=MzAxNzk3NzM2Ng==&mid=2247484418&idx=1&sn=c9a63801c07bc8c8cac23ce84fa608d3&scene=21#wechat_redirect)

#### #claude #claudecode #hook #vibecoding #anthropic #ç¡®å®šæ€§

#### å¼•ç”¨é“¾æ¥

`[1]` å®‰å…¨æ³¨æ„äº‹é¡¹: *https://docs.anthropic.com/en/docs/claude-code/hooks#security-considerations*  
`[2]` æ–œæ å‘½ä»¤: *https://docs.anthropic.com/en/docs/claude-code/slash-commands*  
`[3]` è®¾ç½®æ–‡ä»¶: *https://docs.anthropic.com/en/docs/claude-code/settings*  
`[4]` æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰å·¥å…·: *https://docs.anthropic.com/en/docs/claude-code/mcp*  
`[5]` è®¾ç½®æ–‡ä»¶: *https://docs.anthropic.com/en/docs/claude-code/settings*  

  

ä½ çš„æ”¯æŒæ˜¯æˆ‘æŒç»­åˆ›ä½œçš„åŠ¨åŠ›ï¼

ä¸ªäººè§‚ç‚¹ï¼Œä»…ä¾›å‚è€ƒ

[é˜…è¯»åŸæ–‡](https://mp.weixin.qq.com/s/)

ç»§ç»­æ»‘åŠ¨çœ‹ä¸‹ä¸€ä¸ª

AIå’–å•¡é¦†

å‘ä¸Šæ»‘åŠ¨çœ‹ä¸‹ä¸€ä¸ª